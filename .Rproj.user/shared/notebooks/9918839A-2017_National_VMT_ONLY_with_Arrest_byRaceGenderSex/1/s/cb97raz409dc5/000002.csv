"0","# Returns passenger_flag column which finds if a passenger was in that unit"
"0","find_if_passenger <- function(person_df) {"
"0","  # First get all the passengers"
"0","  passenger <-"
"0","    person_df %>% filter(ROLE == ""Passenger"") %>% select(CRSHNMBR, UNITNMBR)"
"0","  # Then join back to df Drivers to add flag to matching crsh/unit nmbrs"
"0","  pass_join <- person_df %>% filter(ROLE == ""Driver"") %>% semi_join(., passenger, by = c(""CRSHNMBR"",""UNITNMBR"")) %>% mutate(passenger_flag = ""Y"") %>% select(CRSHNMBR, UNITNMBR, passenger_flag)"
"0","  # join back to original"
"0","  left_join(person_df, pass_join, by = c(""CRSHNMBR"",""UNITNMBR"")) %>% mutate(passenger_flag = replace_na(passenger_flag, ""N""))"
"0","}"
