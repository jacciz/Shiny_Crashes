"0","get_age_groups_5yr <- function(dataframe, age_column) {"
"0","  dataframe %>% mutate(age_group_5yr = cut("
"0","    age_column, right = FALSE,"
"0","    c(0,4,9,13,14,15,20,25,29,34,39,44,49,54,59,64,69,74,79,84,88,120),"
"0","    labels = c(""0-4"",""5-9"",""10-13"",""14"", ""15"", ""16-20"",""21-25"",""26-29"",""30-34"",""35-39"",""40-44"", ""45-49"",""50-54"",""55-59"",""60-64"",""65-69"",""70-74"", ""75-79"", ""80-84"", ""85-88"", ""89+""),"
"0","    include.lowest = T"
"0","  )) # age_group_5yr = ifelse(is.na(age_group_5yr), ""Unknown"", levels(age_group_5yr))"
"0","}"
"0",""
"0","get_age_groups_10yr <- function(dataframe, age_column) {"
"0","    dataframe <- dataframe %>% mutate(age_group_10yr = cut("
"0","    age_column,"
"0","    right = FALSE,"
"0","    c(0, 16, 26, 36, 46, 56, 66, 76, 120),"
"0","    labels = c("
"0","      ""<16"","
"0","      ""16-25"","
"0","      ""26-35"","
"0","      ""36-45"","
"0","      ""46-55"","
"0","      ""56-65"","
"0","      ""66-75"","
"0","      ""76+"""
"0","    ),"
"0","    include.lowest = T"
"0","  ))"
"0","  # OLD WAY"
"0","  # dataframe <- dataframe %>% mutate(age_group_10yr = cut("
"0","  #   age_column,"
"0","  #   right = FALSE,"
"0","  #   c(0, 17, 20, 29, 39, 49, 59, 69, 120),"
"0","  #   labels = c("
"0","  #     ""<18"","
"0","  #     ""18-20"","
"0","  #     ""21-29"","
"0","  #     ""30-39"","
"0","  #     ""40-49"","
"0","  #     ""50-59"","
"0","  #     ""60-69"","
"0","  #     ""70+"""
"0","  #   ),"
"0","  #   include.lowest = T"
"0","  # ))"
"0","  # Get levels of age_group factor and add Unknown"
"0","  levels <- levels(dataframe$age_group_10yr)"
"0","  levels[length(levels) + 1] <- ""Unknown"""
"0","  # refactor Species to include ""None"" as a factor level"
"0","  # and replace NA with ""None"""
"0","  dataframe$age_group_10yr <-"
"0","    factor(dataframe$age_group_10yr, levels = levels)"
"0","  dataframe$age_group_10yr[is.na(dataframe$age_group_10yr)] <- ""Unknown"""
"0","  return(dataframe)"
"0","}"
"0",""
"0","# Returns average crash count based on fields_to_summarise"
"0","person_summarise_crash_count <-"
"0","  function(crash_person_df, fields_to_summarise) {"
"0","    # number_of_years is to get the average crash counts"
"0","    # number_of_years = year(person_df$CRSHDATE) %>% unique() %>% length()"
"0","    number_of_years = crash_person_df[unique(year(CRSHDATE)), .N]"
"0","    crash_person_df[, .(crash_count = .N/number_of_years), by = fields_to_summarise]"
"0","  }"
"0","owi_summarise_arrest_count <- "
"0","  function(arrest_df, fields_to_summarise){"
"0","    number_of_years = arrest_df[unique(year(violation_date)), .N]"
"0","    arrest_df[, .(total_arrests = .N/number_of_years), by = intersect(fields_to_summarise, names(arrest_df))]"
"0","  }"
"0",""
"0","census_summarise_pop_count <- "
"0","  function(census_df, fields_to_summarise){"
"0","    # number_of_years = arrest_df[unique(year(violation_date)), .N]"
"0","    census_df[, .(total_population = sum(POP)), by = intersect(fields_to_summarise, names(census_df))]"
"0","  }"
"0",""
