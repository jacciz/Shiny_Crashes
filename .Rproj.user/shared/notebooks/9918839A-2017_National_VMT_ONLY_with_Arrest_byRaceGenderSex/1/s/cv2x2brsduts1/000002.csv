"0","# By race and sex"
"0","# persons_new %>% filter(ROLE == 'Driver') %>% get_counts_of_PMD_crash_drivers(., fields_to_summarise = c(""R_RACE"", ""R_SEX"")) %>%"
"0","#   filter(R_SEX != ""Unknown"") %>%"
"0","#   get_data_of_percents_and_ratios_for_table(., fields_that_were_summarised = c(""R_RACE"", ""R_SEX"")) %>%"
"0","#   select(R_RACE, R_SEX, c(starts_with(""percent""))) %>%"
"0","#   arrange(factor(R_RACE, levels  = race_factor_level)) %>%"
"0","#   pivot_longer(cols = c(starts_with(""percent"")),"
"0","#                values_to = c(""percent_data"")) %>%"
"0","#   filter(R_RACE != ""Total"", name != ""percent_of_arrests_by_pop"") %>%"
"0","#   ggplot(aes("
"0","#     x = factor(R_RACE, levels = race_factor_level),"
"0","#     y = percent_data,"
"0","#     fill = factor(name, levels = percents_factor_levels)"
"0","#   )) +"
"0","#   geom_bar(position = ""dodge"", stat = ""identity"") +"
"0","#   theme_bar_charts(base_size = 8) +"
"0","#   theme(axis.text.y = element_blank()) +"
"0","#   # coord_flip() +"
"0","#   geom_text("
"0","#     aes(label = paste0(round(percent_data, 0), ""%""), color = factor(name, levels = percents_factor_levels)),"
"0","#     position = position_dodge(width = .9),"
"0","#     vjust = -.8,"
"0","#     size = 3,"
"0","#     fontface = ""bold"""
"0","#   ) + scale_y_continuous(expand = expansion(mult = c(0, .05)),"
"0","#                          name = """","
"0","#                          limits = c(0, 70)) +"
"0","#   scale_color_manual( # For geom_text"
"0","#     values = c("
"0","#       ""percent_of_drivers"" = ""#428BCA"","
"0","#       ""percent_of_vmt"" = ""#4DB848"","
"0","#       ""percent_of_crashes"" = ""#D50032"","
"0","#       ""percent_of_arrests"" = ""#d6a60f"""
"0","#     )"
"0","#   ) + #for geom_text"
"0","#   scale_fill_manual( # For bar chart fill"
"0","#     # for bars"
"0","#     name = """","
"0","#     values = c("
"0","#       ""percent_of_drivers"" = ""#428BCA"","
"0","#       ""percent_of_vmt"" = ""#4DB848"","
"0","#       ""percent_of_crashes"" = ""#D50032"","
"0","#       ""percent_of_arrests"" = ""#d6a60f"""
"0","#     )"
"0","#     # labels = c(""Crashes"", ""Drivers"", ""VMT"")"
"0","#   ) +"
"0","#   labs("
"0","#     title = ""<span style='font-size:15pt'>Share of"
"0","#     <span style='color:#428BCA;'>**drivers**</span>,"
"0","#     <span style='color:#4DB848;'>**VMT**</span>,"
"0","#     <span style='color:#D50032;'>**crashes**</span>, and"
"0","#     <span style='color:#d6a60f;'>**OWI arrests**</span> by race and sex"
"0","#     </span>"""
"0","#   ) + facet_wrap( ~ R_SEX)"
