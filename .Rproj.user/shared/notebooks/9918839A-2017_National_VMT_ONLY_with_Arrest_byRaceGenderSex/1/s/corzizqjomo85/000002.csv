"0","# This is according to the codebook"
"0","nhts_relabel_race <- function(df) {"
"0","  df %>%"
"0","    mutate(R_RACE = dplyr::recode("
"0","      R_RACE,"
"0","        '-8' = 'Dont know',"
"0","        '-7' = 'Refused',"
"0","        '01' = 'White',"
"0","        '02' = 'Black or African American',"
"0","        '03' = 'Asian or Pacific Islander',"
"0","        '04' = 'American Indian or Alaska Native',"
"0","        # '05' = 'Native Hawaiian or other Pacific Islander',"
"0","        '05' = 'Asian or Pacific Islander',"
"0","        '06' = 'Multiple responses',"
"0","        '97' = 'Some other race'"
"0","    ))"
"0","}"
"0",""
"0","nhts_combine_unknown_race <- function(df) {"
"0","  df %>%"
"0","    mutate(R_RACE = dplyr::recode("
"0","      R_RACE,"
"0","        'Dont know'= 'Other/Unknown',"
"0","        'Refused' = 'Other/Unknown',"
"0","        'Multiple responses' = 'Other/Unknown',"
"0","        'Some other race' = 'Other/Unknown'"
"0","    ))"
"0","}"
"0",""
"0","nhts_relabel_hispanic <- function(df) {"
"0","  df %>%"
"0","    mutate(R_HISP = dplyr::recode("
"0","      R_HISP, "
"0","        '-8' = 'I dont know',"
"0","        '-7' = 'I prefer not to answer',"
"0","        '01' = 'Yes, Hispanic or Latino',"
"0","        '02' = 'No, Not Hispanic or Latino'"
"0","    ))"
"0","}"
"0",""
"0","nhts_relabel_race_if_hispanic <- function(df) {"
"0","  df %>%"
"0","    mutate(R_RACE = ifelse(R_HISP %in% c(""01"", ""Yes, Hispanic or Latino""), ""Hispanic"", R_RACE)) #%>% "
"0","   # nhts_relabel_race_integ()"
"0","}"
"0",""
"0","nhts_relabel_sex <- function(df) {"
"0","  df %>%"
"0","    mutate(R_SEX = dplyr::recode("
"0","      R_SEX,"
"0","        # '-8' = 'I dont know',"
"0","        # '-7' = 'I prefer not to answer',"
"0","        '-8' = 'Unknown',"
"0","        '-7' = 'Unknown',"
"0","        '01' = 'Male',"
"0","        '02' = 'Female'"
"0","    ))"
"0","}"
"0",""
"0","# These return count total values based on fields_to_summarise (i.e. c(""age_group_10yr"",""R_RACE"",""R_SEX""))"
"0",""
"0","# This is the unweighted data for 'Average Annual Vehicle Miles of Travel Per Driver' - weight is WTPERFIN - total number of persons"
"0","nhts_summarise_pmd <- function(df, fields_to_summarise){"
"0","  df[HHSTATE %in% c(""MI"",""IA"",""IL"",""MN"",""WI"") & DRIVER == ""01"" & YEARMILE >= 0,c(.(PMD=mean(YEARMILE)), nhts_n = .N), by = intersect(fields_to_summarise, names(df))]"
"0","}"
"0",""
"0","# 'Vehicle Trips (Travel Day VT, annualized, weighted)'"
"0","nhts_summarise_vt <- function(df, fields_to_summarise){"
"0","  df[HHSTATE == ""WI"" & DRVR_FLG == ""01"" & TRPTRANS %in% c(""03"", ""04"", ""05"", ""06"", ""08"", ""09"", ""18""),c(.(v_trips=sum(WTTRDFIN)), nhts_n = .N), by = intersect(fields_to_summarise, names(df))]"
"0","}"
"0",""
"0","nhts_summarise_total_drivers <- function(df, fields_to_summarise){"
"0","  df[HHSTATE %in% ""WI"" & DRIVER == ""01"", .(total_drivers=sum(WTPERFIN)), by = intersect(fields_to_summarise, names(df))]"
"0","}"
