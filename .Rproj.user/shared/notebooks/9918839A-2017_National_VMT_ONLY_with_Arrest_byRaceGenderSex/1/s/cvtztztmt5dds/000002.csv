"0","# race_axis_labels <- c('American\nIndian or\nAlaska Native', 'Asian or\nPacific\nIslander', 'Black or\nAfrican\nAmerican', 'Hispanic', 'White', 'Other/\nUnknown') # Took out 'Native Hawaiian or other Pacific Islander'"
"0","# # By race and sex"
"0","# persons_new %>% filter(ROLE == 'Driver') %>% get_counts_of_PMD_crash_drivers(., fields_to_summarise = c(""R_RACE"", ""R_SEX"")) %>%"
"0","#   filter(R_SEX != ""Unknown"") %>%"
"0","#   get_data_of_percents_and_ratios_for_table(., fields_that_were_summarised = c(""R_RACE"", ""R_SEX"")) %>%"
"0","#   select(R_RACE, R_SEX, c(ends_with(""ratio""))) %>%"
"0","#   # arrange(factor(R_RACE, levels  = race_factor_level)) %>%"
"0","#   pivot_longer(cols = c(ends_with(""ratio"")),"
"0","#                values_to = c(""ratio_data"")) %>%"
"0","#   mutate(ratio_data = as.numeric(ratio_data)) %>% "
"0","#   filter(R_RACE != ""Total"") %>%"
"0","#   ggplot(aes("
"0","#     x = factor(R_RACE, levels = race_factor_level),"
"0","#     y = ratio_data,"
"0","#     fill = factor(name, levels = ratios_factor_levels)"
"0","#   )) +"
"0","#   geom_bar(position = ""dodge"", stat = ""identity"") +"
"0","#   theme_bar_charts(base_size = 8) +"
"0","#   theme(axis.text.y = element_blank()) +"
"0","#   # coord_flip() "
"0","#   geom_text("
"0","#     aes(label = ratio_data, color = factor(name, levels = ratios_factor_levels)),"
"0","#     position = position_dodge(width = .9),"
"0","#     vjust = -.8,"
"0","#     size = 3,"
"0","#     fontface = ""bold"""
"0","#   ) +"
"0","#   scale_y_continuous(expand = expansion(mult = c(0, .05)),"
"0","#                          name = """""
"0","#                          # limits = c(0, 10)"
"0","#                      ) +"
"0","#   scale_color_manual( # For geom_text"
"0","#     values = c("
"0","#       ""crash_drivers_ratio"" = ""#428BCA"","
"0","#       ""crash_vmt_ratio"" = ""#4DB848"","
"0","#       ""arrest_driver_ratio"" = ""#D50032"","
"0","#       ""arrest_vmt_ratio"" = ""#d6a60f"""
"0","#     )"
"0","#   ) + #for geom_text"
"0","#   scale_fill_manual( # For bar chart fill"
"0","#     # for bars"
"0","#     name = """","
"0","#     values = c("
"0","#       ""crash_drivers_ratio"" = ""#428BCA"","
"0","#       ""crash_vmt_ratio"" = ""#4DB848"","
"0","#       ""arrest_driver_ratio"" = ""#D50032"","
"0","#       ""arrest_vmt_ratio"" = ""#d6a60f"""
"0","#     )"
"0","#     # labels = c(""Crashes"", ""Drivers"", ""VMT"", ""Arrest to VMT"")"
"0","#   ) +"
"0","#   scale_x_discrete(labels= race_axis_labels) +"
"0","#   labs("
"0","#     title = ""<span style='font-size:15pt'>Ratio of"
"0","#     <span style='color:#428BCA;'>**crash to drivers**</span>,"
"0","#     <span style='color:#4DB848;'>**crash to VMT**</span>,"
"0","#     <span style='color:#D50032;'>**arrest to driver**</span>, and"
"0","#     <span style='color:#d6a60f;'>**arrest to VMT**</span> by race and sex"
"0","#     </span>"""
"0","#   ) + facet_wrap( ~ R_SEX)"
