"0","# These combine all 3 functions and returns a df with all 'summarise' columns"
"0","# crash_person_df - get crash count"
"0","# nhts_person_df - get PMD and driver count"
"0","# nhts_trip_df - get vehicle trip count"
"0",""
"0","# State parameter is not being used yet"
"0","# get_counts_of_PMD_crash_drivers <-"
"0","#   function(crash_person_df = persons_new, arrest_df = arrests1718, nhts_person_df = nhts_person, state = ""WI"", fields_to_summarise) {"
"0","#     get_crash_counts <-"
"0","#       person_summarise_crash_count(crash_person_df, fields_to_summarise)"
"0","#     "
"0","#     owi_counts <- owi_summarise_arrest_count(arrest_df, fields_to_summarise)"
"0","#     "
"0","#     # Get PMD and combine with crash counts"
"0","#     get_pmd_and_crash_counts <-"
"0","#       nhts_summarise_pmd(nhts_person_df, intersect(fields_to_summarise, names(nhts_person_df))) %>% left_join(., get_crash_counts, by = intersect(fields_to_summarise, names(.))) #%>% na.omit()"
"0","#     # Get total drivers and combine with PMD/crash counts"
"0","#     nhts_totdrivers <- nhts_summarise_total_drivers(nhts_person_df, fields_to_summarise = intersect(fields_to_summarise, names(nhts_person_df)))"
"0","#     "
"0","#     get_totaldrivers_pmd_crashes <-"
"0","#       left_join(get_pmd_and_crash_counts, nhts_totdrivers , by = intersect(fields_to_summarise, names(nhts_totdrivers)))"
"0","#     "
"0","#     "
"0","#     return(get_totaldrivers_pmd_crashes)"
"0","#   }"
"0","get_counts_of_PMD_crash_drivers <-"
"0","  function(crash_person_df = persons_new, arrest_df = arrests1718, nhts_person_df = nhts_person, census_df = census17, state = ""WI"", fields_to_summarise) {"
"0","    crash_counts <-person_summarise_crash_count(crash_person_df, fields_to_summarise)"
"0","    owi_counts <- owi_summarise_arrest_count(arrest_df, fields_to_summarise = fields_to_summarise)"
"0","    pmd_counts <- nhts_summarise_pmd(nhts_person_df, fields_to_summarise = fields_to_summarise)"
"0","    nhts_totdrivers <- nhts_summarise_total_drivers(nhts_person_df, fields_to_summarise = fields_to_summarise)"
"0","    census_pop <- census_summarise_pop_count(census_df, fields_to_summarise = fields_to_summarise)"
"0","    "
"0","    return(Reduce(function(x, y) merge(x, y, all=TRUE, by = intersect(fields_to_summarise, names(nhts_person))), list(crash_counts,owi_counts,pmd_counts,nhts_totdrivers,census_pop)))"
"0","    # return(cbind(crash_counts,pmd_counts,owi_counts,nhts_totdrivers, .id = intersect(fields_to_summarise, names(nhts_person))))"
"0","  }"
"0","# fields_to_summarise = ""R_RACE"""
"0","#    crash_counts <-person_summarise_crash_count(persons_new, fields_to_summarise)"
"0","#     owi_counts <- owi_summarise_arrest_count(arrests1718, fields_to_summarise)"
"0","#     pmd_counts <- nhts_summarise_pmd(nhts_person, fields_to_summarise)"
"0","#     nhts_totdrivers <- nhts_summarise_total_drivers(nhts_person, fields_to_summarise)"
"0","#     census_pop <- census_summarise_pop_count(census17, fields_to_summarise)"
"0","#     "
"0","#     (Reduce(function(x, y) merge(x, y, all=TRUE, by = intersect(fields_to_summarise, names(nhts_person))), list(crash_counts,owi_counts,pmd_counts,nhts_totdrivers,census_pop)))"
